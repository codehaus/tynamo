<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:t="http://tapestry.apache.org/schema/tapestry_5_1_0.xsd">

	<head>
		<title>Login page</title>
		<style type="text/css">
			#tynamoLoginFormContainer {
				background: url(${asset:classpath:org/tynamo/examples/federatedaccounts/img/login-bg.png}) no-repeat;
				width:778px;
				height:600px;
				margin:0 auto;
			}
			
			#tynamoLoginForm {
				padding: 90px 110px;
			}
			
			#tynamoLoginMessage {
				color:red;
				margin-bottom: 10px;	
			}
			
			input {
				font-size: 220%;
			}
			
			input[type="text"], input[type="password"] {
				font-size: 220%; width: 400px;
			}
			
			#tynamoLoginContainer {
				margin-bottom: 50px;
			}
			
			#tynamoPasswordContainer {
				margin-bottom: 50px;
			}
			
			#tynamoRememberMeContainer {
				margin-bottom: 40px;
			}
			
			.tynamoMessage {
				margin:0 auto;
			}
		</style>	
	</head>

	<body style="text-align:center;font-family:'lucida grande','lucida sans unicode','bitstream vera sans', 'trebuchet ms',arial,sans-serif;">
		<div class="tynamoMessage">
			${message}
		</div>
		<t:security.notauthenticated>
			<div>
				<h3>Sign in as a Facebook user instead</h3>
				<div>
					<div style="float:left">demonstrating different windowmodes,&nbsp;</div> 		
					<div style="float:left"> 
						blank: <t:federated.facebookSignIn/>
					</div>
					<div style="float:left"> 
						inline: <t:federated.facebookSignIn windowMode="inline"/>
					</div>
					<div style="float:left"> 
						self: <t:federated.facebookSignIn windowMode="self"/>
					</div>
				</div>
				<t:federated.oauthInlineFrame/>
			</div>
			<t:security.loginform />
			(You can use localuser:local as credentials for a local account)
		</t:security.notauthenticated>
		<t:security.authenticated>
			Welcome ${currentUser.displayableName}! <t:actionlink t:id="logout">Logout</t:actionlink>
			<div>
				<t:security.haspermission permission="facebook">
				<t:actionlink zone="friendResults" t:id="listFriends">Check who's my friend</t:actionlink>
				<t:zone t:id="friendResults">
					<t:if test="friends">
						<h1>My Friends</h1>
						<ul>
						<t:loop source="friends" value="friend">
							<li>${friend.name}</li>			
						</t:loop>
						</ul>
					</t:if>
				</t:zone>				
				</t:security.haspermission>
				<t:security.lackspermission permission="facebook">
				Sorry, as a local user you have no friends. Sign in as a facebook user?
				</t:security.lackspermission>
			</div>
		</t:security.authenticated>
		<t:block t:id="friendsBlock">
		</t:block>
	</body>
</html>