<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
		 xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">

	<parent>
		<artifactId>examples</artifactId>
		<groupId>org.tynamo</groupId>
		<version>0.0.1-SNAPSHOT</version>
	</parent>

	<modelVersion>4.0.0</modelVersion>
	<groupId>org.tynamo.examples</groupId>
	<artifactId>simple</artifactId>
	<packaging>war</packaging>
	<name>Tynamo Example - Simple</name>

	<build>
		<finalName>simple</finalName>

		<!-- IGNORE THE TESTS (just until we have time to port them to T5) 
		Also, rewrite to use newer version of html unit and extend the AbstractContainerTest base class rather than rely on cargo
		-->
		<testSourceDirectory>src/test/resources</testSourceDirectory>

		<plugins>
			<plugin>
				<artifactId>maven-surefire-plugin</artifactId>
				<executions>
					<execution>
						<id>surefire-it</id>
						<phase>integration-test</phase>
						<goals>
							<goal>test</goal>
						</goals>
						<configuration>
							<includes>
								<include>
									**/functional/*Test.java
								</include>
							</includes>
							<excludes>
								<exclude>
									**/FunctionalTest.java
								</exclude>
							</excludes>
						</configuration>
					</execution>
				</executions>
				<configuration>
					<includes>
						<include>**/ThingTest.java</include>
					</includes>
				</configuration>
			</plugin>
			<plugin>
				<groupId>org.codehaus.cargo</groupId>
				<artifactId>cargo-maven2-plugin</artifactId>
				<version>1.0</version>
				<configuration>
					<wait>false</wait>
					<container>
						<containerId>tomcat5x</containerId>
						<zipUrlInstaller>
							<url>http://apache.org/dist/tomcat/tomcat-5/v5.5.27/bin/apache-tomcat-5.5.27.zip</url>
						</zipUrlInstaller>
					</container>
					<configuration>
						<properties>
							<!--
								Can't use 8080 on Bamboo
							   java.net.BindException: Address already in use:8080
							-->
							<cargo.servlet.port>9080</cargo.servlet.port>
						</properties>
					</configuration>
				</configuration>
				<executions>
					<execution>
						<id>start-container</id>
						<phase>pre-integration-test</phase>
						<goals>
							<goal>start</goal>
						</goals>
					</execution>
					<execution>
						<id>stop-container</id>
						<phase>post-integration-test</phase>
						<goals>
							<goal>stop</goal>
						</goals>
					</execution>
				</executions>
			</plugin>
		</plugins>
	</build>

	<dependencies>

		<dependency>
			<groupId>hsqldb</groupId>
			<artifactId>hsqldb</artifactId>
			<version>1.8.0.7</version>
		</dependency>

		<dependency>
			<groupId>org.apache.tapestry</groupId>
			<artifactId>tapestry-upload</artifactId>
			<version>${tapestry-release-version}</version>
		</dependency>

		<dependency>
			<groupId>org.tynamo</groupId>
			<artifactId>tynamo-crud-hibernate</artifactId>
		</dependency>

		<dependency>
			<groupId>org.tynamo</groupId>
			<artifactId>tynamo-crud-web</artifactId>
			<type>war</type>
		</dependency>

		<dependency>
			<groupId>org.tynamo</groupId>
			<artifactId>tynamo-crud-test</artifactId>
			<version>0.0.1-SNAPSHOT</version>
			<scope>test</scope>
		</dependency>

	</dependencies>
	
	<profiles>
		<!-- Do not generate the tapestry-component-report on windows because it will fail with "javadoc: error - cannot find doclet class"
		see https://issues.apache.org/jira/browse/TAP5-871
		if you replace backslashes with forward slashes in component-report-javadoc-arguments.txt and run the javadoc manually, it'll work
		-->
		<profile>
			<id>site</id>
			<activation>
				<os>
					<family>!windows</family>
				</os>
			</activation>
			<reporting>
		
				<!-- Adds a report detailing the components, mixins and base classes defined by this module. -->
				<plugins>
					<plugin>
						<groupId>org.apache.tapestry</groupId>
						<artifactId>tapestry-component-report</artifactId>
						<version>${tapestry-release-version}</version>
						<configuration>
							<rootPackage>org.tynamo.examples.simple</rootPackage>
						</configuration>
					</plugin>
				</plugins>
			</reporting>
		</profile>
	</profiles>	
</project>